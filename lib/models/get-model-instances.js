module.exports = (Promise, pluginInfo, entity, instance, relationshipName, TargetClass) => Promise.resolve()
    .then(() => entity.getRelationshipByName(relationshipName))
    .then((relationship) => Promise.resolve()
        .then(() => relationship.getDocuments(pluginInfo.persistence, instance))
        .then((documents) => Promise.map(documents, (doc) => Promise.resolve()
            .then(() => new TargetClass())
            .then((targetInstance) => targetInstance.fromPersistence(Promise, pluginInfo, relationship.getTargetEntity(), doc))
        ))
    )
;
